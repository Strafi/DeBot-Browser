import store from 'src/store';
import tonClient from 'src/tonClient';
import { DEBOT_WC } from 'src/constants';
import { setSigningBox } from 'src/store/actions/debot';
import InterfacesController from './interfaces';

class DebotBrowser {
	constructor() {
		this.debot_handle = null;
		this.debot_abi = null;
		this.info = null;
	}

	setDebotParams(params) {
		const { debot_handle, debot_abi, info } = params;

		this.debot_handle = debot_handle;
		this.debot_abi = debot_abi;
		this.info = info;
	}

	log(loggerParams) {
		const browserParams = {
			debot_handle: this.debot_handle,
			debot_abi: this.debot_abi,
			info: this.info,
		};
		console.log(browserParams, loggerParams);
	};

	switch(params) {
		console.log(params)
	};

	switch_completed() {
		console.log({ msg: 'Switch completed' })
	};

	show_action(params) {
		console.log(params)
	};

	input(params) {
		console.log(params)
	};

	async get_signing_box() {
		const keysPromise = new Promise((resolve) => {
			store.dispatch(setSigningBox({
				submit: resolve,
			}));
		});

		const keys = await keysPromise;

		const { handle } = await tonClient.crypto.get_signing_box(keys);

		store.dispatch(setSigningBox(null));

		return { signing_box: handle };
	};

	invoke_debot(params) {
		console.log(params)
	};

	async send(params) {
		const parsedMessage = await tonClient.boc.parse_message({ boc: params.message })

		const { dst, src, dst_workchain_id } = parsedMessage.parsed;
		const [, interfaceId] = dst.split(':');

		if (dst_workchain_id === DEBOT_WC) {
			InterfacesController.delegateToInterface(interfaceId, {
				debotAddress: src,
				...params,
			});
		} else {
			console.log('call other debot', parsedMessage, params);
			// call other debot
		}
	};

	approve(params) {
		console.log(params)
		// {
		// 	activity: {
		// 		activity:
		// 		dst: "0:d17e6cd2b2d1d6a8fe2f72559dc20f416ed9fc0e8520f4250b848f5c7e73cc61"
		// 		fee: 72535001
		// 		msg: "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"
		// 		out: []
		// 		setcode: false
		// 		signkey: "9711a04f0b19474272bc7bae5472a8fbbb6ef71ce9c193f5ec3f5af808069a41"
		// 		type: "Transaction"
		// 		__proto__: Object
		// 	},
		// 	type: "Approve",
		// }
	};
}

export default DebotBrowser;